<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zapatos Escolares para Ni√±os - Detalles</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo">
                    <a href="../index.html" class="logo-link">
                        <img src="../img/logo-detalles.jpg" alt="Detalles - Calzados y Accesorios">
                    </a>
                </div>
                
                <ul class="nav-menu">
                    <li><a href="../index.html">Inicio</a></li>
                    
                    <!-- Submen√∫ Mujeres -->
                    <li class="menu-item-has-children">
                        <a href="#mujeres">Mujeres <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <div class="submenu-content">
                                <div class="submenu-column">
                                    <h3>Calzado</h3>
                                    <ul>
                                        <li><a href="../mujeres/zapatillas-deportivas.html">Zapatillas Deportivas</a></li>
                                        <li><a href="../mujeres/zapatos-casuales.html">Zapatos Casuales</a></li>
                                        <li><a href="../mujeres/tacones.html">Tacones</a></li>
                                        <li><a href="../mujeres/sandalias.html">Sandalias</a></li>
                                        <li><a href="../mujeres/botas.html">Botas</a></li>
                                    </ul>
                                </div>
                                <div class="submenu-column">
                                    <h3>Accesorios</h3>
                                    <ul>
                                        <li><a href="../mujeres-accesorios/bolsos.html">Bolsos</a></li>
                                        <li><a href="../mujeres-accesorios/billeteras.html">Billeteras</a></li>
                                        <li><a href="../mujeres-accesorios/gafas-de-sol.html">Gafas de Sol</a></li>
                                        <li><a href="../mujeres-accesorios/cinturones.html">Cinturones</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>
                    
                    <!-- Submen√∫ Hombres -->
                    <li class="menu-item-has-children">
                        <a href="#hombres">Hombres <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <div class="submenu-content">
                                <div class="submenu-column">
                                    <h3>Calzado</h3>
                                    <ul>
                                        <li><a href="../hombres/zapatillas-deportivas-h.html">Zapatillas Deportivas</a></li>
                                        <li><a href="../hombres/zapatos-casuales-h.html">Zapatos Casuales</a></li>
                                        <li><a href="../hombres/zapatos-formales-h.html">Zapatos Formales</a></li>
                                        <li><a href="../hombres/botas-h.html">Botas</a></li>
                                        <li><a href="../hombres/sandalias-h.html">Sandalias</a></li>
                                    </ul>
                                </div>
                                <div class="submenu-column">
                                    <h3>Accesorios</h3>
                                    <ul>
                                        <li><a href="../hombres-accesorios/cinturones-h.html">Cinturones</a></li>
                                        <li><a href="../hombres-accesorios/relojes-h.html">Relojes</a></li>
                                        <li><a href="../hombres-accesorios/gafas-de-sol-h.html">Gafas de Sol</a></li>
                                        <li><a href="../hombres-accesorios/billeteras-h.html">Billeteras</a></li>
                                        <li><a href="../hombres-accesorios/gorros-h.html">Gorros</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>
                    
                    <!-- Submen√∫ Ni√±os -->
                    <li class="menu-item-has-children">
                        <a href="#ninos">Ni√±os <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <div class="submenu-content">
                                <div class="submenu-column">
                                    <h3>Calzado</h3>
                                    <ul>
                                        <li><a href="zapatillas-deportivas.html">Zapatillas Deportivas</a></li>
                                        <li><a href="zapatos-casuales.html">Zapatos Casuales</a></li>
                                        <li><a href="zapatos-escolares.html">Zapatos Escolares</a></li>
                                        <li><a href="pantuflas.html">Pantuflas</a></li>
                                        <li><a href="sandalias.html">Sandalias</a></li>
                                        <li><a href="botas.html">Botas</a></li>
                                    </ul>
                                </div>
                                <div class="submenu-column">
                                    <h3>Accesorios</h3>
                                    <ul>
                                        <li><a href="../ni√±os-accesorios/calcetines.html">Calcetines</a></li>
                                        <li><a href="../ni√±os-accesorios/cinturones.html">Cinturones</a></li>
                                        <li><a href="../ni√±os-accesorios/gorras.html">Gorras</a></li>
                                        <li><a href="../ni√±os-accesorios/lentes-sol.html">Lentes</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
                
                <div class="nav-icons">
                    <!-- BARRA DE B√öSQUEDA FUNCIONAL -->
                    <div class="search-container">
                        <div class="search-form">
                            <input type="text" id="searchInput" placeholder="Buscar productos..." class="search-input">
                            <button onclick="buscarProductos()" class="search-button">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                    <a href="../login/logueo.html" class="nav-icon"><i class="fas fa-user"></i></a>
                    <a href="../carrito/carritos.html" class="nav-icon cart-icon">
                        <i class="fas fa-shopping-bag"></i>
                        <span class="cart-count">0</span>
                    </a>
                </div>
                
                <div class="hamburger">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../index.html">Inicio</a> / 
            <a href="#ninos">Ni√±os</a> / 
            <span>Zapatos Escolares</span>
        </div>
    </div>

    <!-- Products Page -->
    <section class="products-page">
        <div class="products-container">
            <!-- Filters Sidebar -->
            <aside class="filters-sidebar">
                <div class="filter-section">
                    <h3>Precio</h3>
                    <div class="price-filter">
                        <input type="range" class="price-range" min="0" max="120" value="60">
                        <div class="price-inputs">
                            <input type="number" placeholder="M√≠n" value="0">
                            <input type="number" placeholder="M√°x" value="120">
                        </div>
                    </div>
                </div>

                <!-- <div class="filter-section">
                    <h3>Talla</h3>
                    <div class="size-filter">
                        <div class="size-option">20</div>
                        <div class="size-option">21</div>
                        <div class="size-option">22</div>
                        <div class="size-option">23</div>
                        <div class="size-option">24</div>
                        <div class="size-option">25</div>
                        <div class="size-option">26</div>
                        <div class="size-option">27</div>
                        <div class="size-option">28</div>
                        <div class="size-option">29</div>
                        <div class="size-option">30</div>
                        <div class="size-option">31</div>
                        <div class="size-option">32</div>
                        <div class="size-option">33</div>
                        <div class="size-option">34</div>
                        <div class="size-option">35</div>
                        <div class="size-option">36</div>
                    </div>
                </div>

                <div class="filter-section">
                    <h3>Color</h3>
                    <div class="color-filter">
                        <div class="color-option" style="background: #000;" title="Negro"></div>
                        <div class="color-option" style="background: #fff; border: 1px solid #ddd;" title="Blanco"></div>
                        <div class="color-option" style="background: #795548;" title="Marr√≥n"></div>
                        <div class="color-option" style="background: #1a237e;" title="Azul Marino"></div>
                        <div class="color-option" style="background: #424242;" title="Gris"></div>
                    </div>
                </div> -->

                <div class="filter-section">
                    <h3>Marca</h3>
                    <div class="brand-filter">
                        <label class="brand-option">
                            <input type="checkbox"> Clarks
                        </label>
                        <label class="brand-option">
                            <input type="checkbox"> Hush Puppies
                        </label>
                        <label class="brand-option">
                            <input type="checkbox"> Bata
                        </label>
                        <label class="brand-option">
                            <input type="checkbox"> North Star
                        </label>
                        <label class="brand-option">
                            <input type="checkbox"> Kickers
                        </label>
                    </div>
                </div>

             
                <div class="filter-section">
                    <h3>Material</h3>
                    <div class="brand-filter">
                        <label class="brand-option">
                            <input type="checkbox"> Cuero
                        </label>
                        <label class="brand-option">
                            <input type="checkbox"> Sint√©tico
                        </label>
                        <label class="brand-option">
                            <input type="checkbox"> Charol
                        </label>
                    </div>
                </div>

                

                <button class="btn-add-cart" style="width: 100%; margin-top: 1rem;" onclick="aplicarFiltros()">Aplicar Filtros</button>
            </aside>

            <!-- Products Main Content -->
            <main class="products-main">
                <div class="products-header">
                    <h1>Zapatos Escolares para Ni√±os</h1>
                    <div class="sort-options">
                        <span class="products-count" id="productsCount">Cargando...</span>
                       
                    </div>
                </div>

                <div class="products-grid-detailed" id="productosContainer">
                    <!-- Los productos se cargar√°n din√°micamente desde la API -->
                    <div class="loading-message">Cargando zapatos escolares...</div>
                </div>
                
                <div class="pagination">
                    <!-- Paginaci√≥n si es necesaria -->
                </div>
            </main>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Detalles</h3>
                    <p>Tu destino para calzados y accesorios de calidad.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Servicios</h3>
                    <ul>
                        <li><a href="../Servicios/guia_tallas.html">Gu√≠a de Tallas</a></li>
                        <li><a href="../Servicios/preguntas.html">Asistente</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Newsletter</h3>
                    <p>Suscr√≠bete para recibir ofertas exclusivas</p>
                    <form class="newsletter-form">
                        <input type="email" placeholder="Tu email" required>
                        <button type="submit">Suscribirse</button>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Detalles. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>
    
    <div id="quickViewModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-body">
                <div id="modal-loader" style="display:none;text-align:center;padding:2rem;">
                    <i class="fas fa-spinner fa-spin fa-2x"></i>
                </div>
                <div id="modal-product-detail" style="display:none;">
                    <div class="modal-product-image">
                        <img id="modal-product-img" src="" alt="Imagen del producto" style="max-width:200px;max-height:200px;object-fit:contain;">
                    </div>
                    <div class="modal-product-info">
                        <h2 id="modal-product-name"></h2>
                        <p id="modal-product-desc"></p>
                        <div class="modal-product-price">
                            <span id="modal-product-price"></span>
                        </div>
                        <div class="modal-product-tallas">
                            <label>Talla:</label>
                            <div id="modal-tallas-list" class="modal-tallas-list"></div>
                        </div>
                        <div class="modal-product-colores">
                            <label>Color:</label>
                            <div id="modal-colores-list" class="modal-colores-list"></div>
                        </div>
                        <button id="modal-add-cart-btn" class="btn-add-cart" style="margin-top:1rem;width:100%;">Agregar al carrito</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../js/script.js"></script>
    <script src="../js/carrito.js"></script>

    <!-- JavaScript para b√∫squeda y filtros din√°micos -->
    <script>
        // Variables globales
        let todosLosProductos = [];
        let productosFiltrados = [];

        // Cargar productos al iniciar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            cargarZapatosEscolaresNinos();
            configurarFiltros();
        });

        // Funci√≥n principal para cargar productos
        async function cargarZapatosEscolaresNinos() {
            try {
                console.log('Cargando zapatos escolares para ni√±os...');
                
                // Primero intentar con filtros espec√≠ficos, si no funciona cargar todos los productos de ni√±os
                let response = await fetch('/api/productos/buscar?categoria=ninos&tipo=zapatos-escolares');
                
                if (!response.ok) {
                    throw new Error('Error en la respuesta de la API');
                }
                
                let productos = await response.json();
                
                // Si no hay resultados, cargar todos los productos de ni√±os
                if (!productos || productos.length === 0) {
                    console.log('No se encontraron zapatos escolares espec√≠ficos, cargando todos los productos de ni√±os...');
                    response = await fetch('/api/productos/buscar?categoria=ninos');
                    productos = await response.json();
                }
                
                console.log('Productos cargados:', productos);
                
                todosLosProductos = productos;
                productosFiltrados = [...productos];
                
                mostrarProductos(productos);
                actualizarContadorProductos(productos.length);
                
            } catch (error) {
                console.error('Error cargando productos:', error);
                document.getElementById('productosContainer').innerHTML = 
                    '<p class="error-message">Error al cargar los productos. Intenta nuevamente.</p>';
            }
        }

        // Funci√≥n para mostrar productos en la p√°gina
        function mostrarProductos(productos) {
            const contenedor = document.getElementById('productosContainer');
            
            if (!productos || productos.length === 0) {
                contenedor.innerHTML = `
                    <div class="no-products">
                        <i class="fas fa-search" style="font-size: 48px; color: #ccc; margin-bottom: 20px;"></i>
                        <h3>No se encontraron zapatos escolares</h3>
                        <p>Intenta con otros filtros o t√©rminos de b√∫squeda.</p>
                    </div>
                `;
                return;
            }

            // Generar HTML para cada producto
            contenedor.innerHTML = productos.map(function(producto){
                return '' +
                    '<div class="product-card-detailed" data-product-id="' + (producto.id || '') + '">' +
                        '<div class="product-image-detailed">' +
                            '<img src="' + (producto.imagenUrl || 'https://via.placeholder.com/300x300') + '" alt="' + (producto.nombre || producto.nombre_producto || '') + '" onerror="this.src=\'https://via.placeholder.com/300x300\'">' +
                            '<div class="product-overlay"><button class="quick-view" onclick="vistaRapida(\'' + (producto.id || '') + '\')">Vista R√°pida</button></div>' +
                        '</div>' +
                        '<div class="product-info-detailed">' +
                            '<div class="product-brand">' + obtenerMarcaProducto(producto) + '</div>' +
                            '<h3 class="product-title-detailed">' + (producto.nombre || producto.nombre_producto || 'Producto') + '</h3>' +
                            '<div class="product-price"><span class="current-price">S/ ' + (producto.precio_venta || producto.precioVenta || producto.precio || '0.00') + '</span></div>' +
                            '<div class="product-actions">' +
                                '<button class="btn-add-cart" onclick="agregarAlCarrito(\'' + (producto.id || '') + '\')">A√±adir al Carrito</button>' +
                                '<button class="btn-wishlist" onclick="agregarFavoritos(\'' + (producto.id || '') + '\')"><i class="far fa-heart"></i></button>' +
                            '</div>' +
                        '</div>' +
                    '</div>';
            }).join('');
        }

        // Funci√≥n para extraer marca del nombre del producto
        function obtenerMarcaProducto(producto) {
            const nombre = producto.nombre || producto.nombre_producto || '';
            // Extraer primera palabra como marca
            return nombre.split(' ')[0] || 'MARCA';
        }

        // Funci√≥n para b√∫squeda desde el navbar
        async function buscarProductos() {
            const searchTerm = document.getElementById('searchInput').value.trim();
            
            if (!searchTerm) {
                // Si no hay t√©rmino de b√∫squeda, recargar productos originales
                cargarZapatosEscolaresNinos();
                return;
            }
            
            try {
                console.log('Buscando:', searchTerm);
                const response = await fetch(`/api/productos/buscar?nombre=${encodeURIComponent(searchTerm)}&categoria=ninos`);
                const productos = await response.json();
                
                productosFiltrados = productos;
                mostrarProductos(productos);
                actualizarContadorProductos(productos.length);
                
            } catch (error) {
                console.error('Error en b√∫squeda:', error);
            }
        }

        // Configurar eventos de filtros
        function configurarFiltros() {
            // Filtro de precio
            const precioRange = document.querySelector('.price-range');
            const precioMin = document.querySelector('.price-inputs input[placeholder="M√≠n"]');
            const precioMax = document.querySelector('.price-inputs input[placeholder="M√°x"]');
            
            if (precioRange && precioMin && precioMax) {
                precioRange.addEventListener('input', function() {
                    precioMax.value = this.value;
                    aplicarFiltros();
                });
                
                precioMin.addEventListener('change', aplicarFiltros);
                precioMax.addEventListener('change', aplicarFiltros);
            }
            
            // Filtro de tallas
            const tallas = document.querySelectorAll('.size-option');
            tallas.forEach(talla => {
                talla.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    aplicarFiltros();
                });
            });
            
            // Filtro de colores
            const colores = document.querySelectorAll('.color-option');
            colores.forEach(color => {
                color.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    aplicarFiltros();
                });
            });
            
            // Filtro de marcas
            const marcas = document.querySelectorAll('.filter-section:nth-child(4) .brand-option input[type="checkbox"]');
            marcas.forEach(marca => {
                marca.addEventListener('change', aplicarFiltros);
            });
            
            // Filtro de g√©neros
            const generos = document.querySelectorAll('.filter-section:nth-child(5) .brand-option input[type="checkbox"]');
            generos.forEach(genero => {
                genero.addEventListener('change', aplicarFiltros);
            });
            
            // Filtro de materiales
            const materiales = document.querySelectorAll('.filter-section:nth-child(6) .brand-option input[type="checkbox"]');
            materiales.forEach(material => {
                material.addEventListener('change', aplicarFiltros);
            });
            
            // Filtro de tipos
            const tipos = document.querySelectorAll('.filter-section:nth-child(7) .brand-option input[type="checkbox"]');
            tipos.forEach(tipo => {
                tipo.addEventListener('change', aplicarFiltros);
            });
        }

        // Funci√≥n para aplicar todos los filtros
        function aplicarFiltros() {
            console.log('üéØ Aplicando filtros...');
            
            let productos = [...todosLosProductos];
            
            // 1. FILTRAR POR PRECIO
            const precioMin = parseInt(document.querySelector('.price-inputs input[placeholder="M√≠n"]')?.value) || 0;
            const precioMax = parseInt(document.querySelector('.price-inputs input[placeholder="M√°x"]')?.value) || 9999;
            
            console.log('üí∞ Filtro precio:', { precioMin, precioMax });
            
            productos = productos.filter(producto => {
                const precio = producto.precio_venta || producto.precioVenta || producto.precio || 0;
                return precio >= precioMin && precio <= precioMax;
            });
            
            // 2. FILTRAR POR COLORES SELECCIONADOS
            const coloresSeleccionados = Array.from(document.querySelectorAll('.color-option.selected'))
                .map(color => {
                    const title = color.getAttribute('title');
                    return title ? title.toLowerCase() : '';
                })
                .filter(color => color !== '');
            
            console.log('üé® Colores seleccionados:', coloresSeleccionados);
            
            if (coloresSeleccionados.length > 0) {
                productos = productos.filter(producto => 
                    producto.color && coloresSeleccionados.includes(producto.color.toLowerCase())
                );
            }
            
            // 3. FILTRAR POR MARCAS SELECCIONADAS (extraer marca del nombre)
            const marcasSeleccionadas = Array.from(document.querySelectorAll('.filter-section:nth-child(4) .brand-option input[type="checkbox"]:checked'))
                .map(cb => {
                    const label = cb.parentElement;
                    return label.textContent.trim().toLowerCase();
                });
            
            console.log('üè∑Ô∏è Marcas seleccionadas:', marcasSeleccionadas);
            
            if (marcasSeleccionadas.length > 0) {
                productos = productos.filter(producto => {
                    // Extraer marca del nombre del producto (primera palabra)
                    const marcaProducto = obtenerMarcaProducto(producto).toLowerCase();
                    return marcaProducto && marcasSeleccionadas.includes(marcaProducto);
                });
            }
            
            console.log('‚úÖ Productos despu√©s de filtros:', productos);
            
            productosFiltrados = productos;
            mostrarProductos(productos);
            actualizarContadorProductos(productos.length);
        }

        // Actualizar contador de productos
        function actualizarContadorProductos(cantidad) {
            const contador = document.getElementById('productsCount');
            if (contador) {
                contador.textContent = `${cantidad} producto${cantidad !== 1 ? 's' : ''}`;
            }
        }

        // Funciones auxiliares (puedes implementarlas despu√©s)
        function vistaRapida(productoId) {
            openQuickView(productoId);
        }

        function agregarAlCarrito(productoId) {
            alert(`Producto ${productoId} agregado al carrito`);
            // Aqu√≠ integrar√°s con tu l√≥gica del carrito
        }

        function agregarFavoritos(productoId) {
            alert(`Producto ${productoId} agregado a favoritos`);
        }

        // Modal de detalles de producto
        const quickViewModal = document.getElementById('quickViewModal');
        const closeModalBtn = document.querySelector('#quickViewModal .close-modal');
        const modalLoader = document.getElementById('modal-loader');
        const modalProductDetail = document.getElementById('modal-product-detail');
        const modalProductImg = document.getElementById('modal-product-img');
        const modalProductName = document.getElementById('modal-product-name');
        const modalProductDesc = document.getElementById('modal-product-desc');
        const modalProductPrice = document.getElementById('modal-product-price');
        const modalTallasList = document.getElementById('modal-tallas-list');
        const modalColoresList = document.getElementById('modal-colores-list');
        const modalAddCartBtn = document.getElementById('modal-add-cart-btn');
        let selectedTalla = null;
        let selectedColor = null;
        let currentProductId = null;

        function openQuickView(productId) {
            quickViewModal.style.display = 'block';
            modalLoader.style.display = 'block';
            modalProductDetail.style.display = 'none';
            selectedTalla = null;
            selectedColor = null;
            currentProductId = productId;
            fetch(`/api/productos/${productId}`)
                .then(res => res.json())
                .then(producto => {
                    modalProductImg.src = producto.imagen || '../img/calzado-default.jpg';
                    modalProductName.textContent = producto.nombre || producto.nombre_producto || 'Producto';
                    modalProductDesc.textContent = producto.descripcion || 'Sin descripci√≥n.';
                    modalProductPrice.textContent = producto.precio ? `S/ ${producto.precio}` : '';
                    // Render tallas
                    modalTallasList.innerHTML = '';
                    (producto.tallas || []).forEach(talla => {
                        const btn = document.createElement('button');
                        btn.className = 'modal-talla-btn';
                        btn.textContent = talla;
                        btn.onclick = () => {
                            document.querySelectorAll('.modal-talla-btn').forEach(b => b.classList.remove('selected'));
                            btn.classList.add('selected');
                            selectedTalla = talla;
                        };
                        modalTallasList.appendChild(btn);
                    });
                    // Render colores
                    modalColoresList.innerHTML = '';
                    (producto.colores || []).forEach(color => {
                        const btn = document.createElement('button');
                        btn.className = 'modal-color-btn';
                        btn.style.background = color;
                        btn.title = color;
                        btn.onclick = () => {
                            document.querySelectorAll('.modal-color-btn').forEach(b => b.classList.remove('selected'));
                            btn.classList.add('selected');
                            selectedColor = color;
                        };
                        modalColoresList.appendChild(btn);
                    });
                    modalLoader.style.display = 'none';
                    modalProductDetail.style.display = 'flex';
                })
                .catch(() => {
                    modalLoader.style.display = 'none';
                    modalProductDetail.innerHTML = '<p style="color:red;">No se pudo cargar el producto.</p>';
                    modalProductDetail.style.display = 'block';
                });
        }
        closeModalBtn.onclick = function() {
            quickViewModal.style.display = 'none';
        };
        window.onclick = function(event) {
            if (event.target === quickViewModal) {
                quickViewModal.style.display = 'none';
            }
        };
        if (modalAddCartBtn) {
            modalAddCartBtn.onclick = function() {
                if (!currentProductId || !selectedTalla || !selectedColor) {
                    alert('Selecciona talla y color.');
                    return;
                }
                fetch('/api/cart/add', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ productoId: currentProductId, talla: selectedTalla, color: selectedColor, cantidad: 1 })
                })
                .then(res => res.ok ? res.json() : Promise.reject())
                .then(() => {
                    alert('Producto agregado al carrito');
                    quickViewModal.style.display = 'none';
                })
                .catch(() => alert('No se pudo agregar al carrito.'));
            };
        }
        // Integrar con botones de productos
        function vistaRapida(productoId) {
            openQuickView(productoId);
        }
    </script>
</body>
</html>