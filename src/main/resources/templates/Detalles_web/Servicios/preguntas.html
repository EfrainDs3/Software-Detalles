<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Asistente IA - Detalles</title>
	<link rel="stylesheet" href="../styles.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	<base href="/src/main/resources/templates/Detalles_web/">

	<style>
		:root{--accent:#e91e63;--muted:#6b6f76;--bg:#f6f8fb;--card:#fff;--radius:12px;--max-width:1100px}
		body{font-family:Inter,system-ui,Roboto,Arial;background:var(--bg);margin:0;color:#222;-webkit-font-smoothing:antialiased}
		.container{max-width:var(--max-width);margin:0 auto;padding:2rem}
		.hero{background:linear-gradient(90deg,rgba(233,30,99,0.06),rgba(33,150,243,0.03));border-radius:var(--radius);padding:1.2rem;margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center;gap:1rem;box-shadow:0 8px 30px rgba(16,24,40,0.04)}
		.hero h1{margin:0;color:var(--accent);font-size:1.4rem} .hero p{margin:0;color:var(--muted)}
		.assistant-grid{display:grid;grid-template-columns: 1fr 340px;gap:1rem}
		.card{background:var(--card);border-radius:10px;padding:1rem;box-shadow:0 6px 20px rgba(16,24,40,0.03)}
		.profile-row{display:flex;gap:.6rem;align-items:center;margin-bottom:.6rem}
		.profile-row label{font-weight:700;font-size:.95rem;color:#333}
		.select, .input {padding:.5rem .7rem;border:1px solid #eef2f6;border-radius:8px;background:#fff}
		.chat-window{height:520px;overflow:auto;border-radius:8px;padding:1rem;background:linear-gradient(#fff,#fbfdff);display:flex;flex-direction:column;gap:.6rem}
		.msg{max-width:78%;padding:.6rem .75rem;border-radius:12px}
		.msg.user{align-self:flex-end;background:linear-gradient(180deg,#e9e9ff,#dcdcff);font-weight:600}
		.msg.ai{align-self:flex-start;background:#f1f5fb;color:#0b2b47}
		.input-row{display:flex;gap:.5rem;margin-top:.75rem}
		.btn{background:var(--accent);color:#fff;border:0;padding:.55rem .9rem;border-radius:10px;cursor:pointer}
		.suggestions{display:flex;flex-wrap:wrap;gap:.4rem;margin-top:.6rem}
		.tag{background:#f1f3f5;padding:6px 10px;border-radius:999px;font-weight:600;cursor:pointer}
		.muted{color:var(--muted)}
		@media (max-width:920px){.assistant-grid{grid-template-columns:1fr;}.chat-window{height:420px}}
	</style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo">
                    <h1>Detalles</h1>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html">Inicio</a></li>
                    
                    <!-- Submenú Mujeres -->
                    <li class="menu-item-has-children">
                        <a href="#mujeres">Mujeres <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <div class="submenu-content">
                                <div class="submenu-column">
                                    <h3>Calzado</h3>
                                    <ul>
                                        <li><a href="mujeres/zapatillas-deportivas.html">Zapatillas Deportivas</a></li>
                                        <li><a href="mujeres/zapatos-casuales.html">Zapatos Casuales</a></li>
                                        <li><a href="mujeres/tacones.html">Tacones</a></li>
                                        <li><a href="mujeres/sandalias.html">Sandalias</a></li>
                                        <li><a href="mujeres/botas.html">Botas</a></li>
                                    </ul>
                                </div>
                                <div class="submenu-column">
                                    <h3>Accesorios</h3>
                                    <ul>
                                        <li><a href="mujeres-accesorios/bolsos.html">Bolsos</a></li>
                                        <li><a href="mujeres-accesorios/billeteras.html">Billeteras</a></li>
                                        <li><a href="mujeres-accesorios/gafas-de-sol.html">Gafas de Sol</a></li>
                                        <li><a href="mujeres-accesorios/cinturones.html">Cinturones</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>
                    
                    <!-- Submenú Hombres -->
                    <li class="menu-item-has-children">
                        <a href="#hombres">Hombres <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <div class="submenu-content">
                                <div class="submenu-column">
                                    <h3>Calzado</h3>
                                    <ul>
                                        <li><a href="hombres/zapatillas-deportivas-h.html">Zapatillas Deportivas</a></li>
                                        <li><a href="hombres/zapatos-casuales-h.html">Zapatos Casuales</a></li>
                                        <li><a href="hombres/zapatos-formales-h.html">Zapatos Formales</a></li>
                                        <li><a href="hombres/botas-h.html">Botas</a></li>
                                        <li><a href="hombres/sandalias-h.html">Sandalias</a></li>
                                    </ul>
                                </div>
                                <div class="submenu-column">
                                    <h3>Accesorios</h3>
                                    <ul>
                                        <li><a href="hombres-accesorios/cinturones-h.html">Cinturones</a></li>
                                        <li><a href="hombres-accesorios/relojes-h.html">Relojes</a></li>
                                        <li><a href="hombres-accesorios/gafas-de-sol-h.html">Gafas de Sol</a></li>
                                        <li><a href="hombres-accesorios/billeteras-h.html">Billeteras</a></li>
                                        <li><a href="hombres-accesorios/gorros-h.html">Gorros</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>             
                    <li class="menu-item-has-children">
                        <a href="#ninos">Niños <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <div class="submenu-content">
                                <div class="submenu-column">
                                    <h3>Calzado</h3>
                                    <ul>
                                        <li><a href="niños/zapatillas-deportivas.html">Zapatillas Deportivas</a></li>
                                        <li><a href="niños/zapatos-casuales.html">Zapatos Casuales</a></li>
                                        <li><a href="niños/zapatos-escolares.html">Zapatos Escolares</a></li>
                                        <li><a href="niños/pantuflas.html">Pantuflas</a></li>
                                        <li><a href="niños/sandalias.html">Sandalias</a></li>
                                        <li><a href="niños/botas.html">Botas</a></li>
                                    </ul>
                                </div>
                                <div class="submenu-column">
                                    <h3>Accesorios</h3>
                                    <ul>
                                        <li><a href="niños-accesorios/calcetines.html">Calcetines</li>
                                        <li><a href="niños-accesorios/cinturones.html">Cinturones</a></li>
                                        <li><a href="niños-accesorios/gorras.html">Gorras</a></li>
                                        <li><a href="niños-accesorios/lentes-sol.html">Lentes</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
                <div class="nav-icons">
                    <a href="#" class="nav-icon search-icon"><i class="fas fa-search"></i></a>
                    <a href="login/logueo.html" class="nav-icon"><i class="fas fa-user"></i></a>
                    <a href="carrito/carritos.html" class="nav-icon cart-icon">
                        <i class="fas fa-shopping-bag"></i>
                        <span class="cart-count">0</span>
                    </a>
                </div>
                
                <div class="hamburger">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </nav>
    </header>
	<!-- Breadcrumb -->
	<div class="breadcrumb"><div class="breadcrumb-content"><span>Asistente IA</span></div></div>

	<main class="container">
		<section class="hero">
			<div>
				<h1>Asistente IA</h1>
				<p class="muted">Recibe recomendaciones de accesorios y colores según tono de piel, ocasión y gustos. Prueba con una pregunta.</p>
			</div>
			<div>
				<button id="resetProfile" class="btn">Nuevo perfil</button>
			</div>
		</section>

		<section class="assistant-grid">
			<!-- Chat principal -->
			<div class="card">
				<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:.6rem">
					<strong>Chat con Asistente</strong>
					<small class="muted">Respuestas rápidas</small>
				</div>

				<div id="chat" class="chat-window" role="log" aria-live="polite">
					<div class="msg ai">Hola — soy tu asistente. Dime para qué ocasión y tu preferencia de colores.</div>
				</div>

				<div class="suggestions muted">Sugerencias:
					<span class="tag" data-q="Recomiendame accesorios para piel morena y evento formal">Evento formal</span>
					<span class="tag" data-q="¿Qué colores combinan con piel clara?">Colores para piel clara</span>
					<span class="tag" data-q="Accesorios casuales para primavera">Casual primavera</span>
				</div>

				<div class="input-row" style="margin-top:.6rem">
					<input id="query" class="input" placeholder="Escribe tu consulta..." aria-label="Mensaje al asistente" />
					<button id="sendBtn" class="btn"><i class="fas fa-paper-plane"></i></button>
				</div>
			</div>

			<!-- Panel lateral: perfil y opciones -->
			<aside class="card">
				<div style="margin-bottom:.6rem"><strong>Perfil y Preferencias</strong></div>

				<div class="profile-row">
					<label for="skinTone">Tono de piel</label>
					<select id="skinTone" class="select" aria-label="Tono de piel">
						<option value="clara">Clara</option>
						<option value="media">Media</option>
						<option value="morena">Morena</option>
						<option value="oscura">Oscura</option>
					</select>
				</div>

				<div class="profile-row">
					<label for="stylePref">Estilo</label>
					<select id="stylePref" class="select" aria-label="Estilo preferido">
						<option value="casual">Casual</option>
						<option value="formal">Formal</option>
						<option value="deportivo">Deportivo</option>
						<option value="elegante">Elegante</option>
					</select>
				</div>

				<div style="margin-top:.6rem">
					<label class="muted" style="font-weight:700">Presupuesto aproximado</label>
					<input id="budget" class="input" placeholder="$ - opcional" />
				</div>

				<hr style="margin:1rem 0;border-color:#f1f3f5">

				<div>
					<strong>Cómo funciona</strong>
					<p class="muted" style="font-size:.95rem">El asistente usa tus preferencias para dar recomendaciones. En producción debes conectar /api/assistant a un servicio IA.</p>
				</div>
			</aside>
		</section>
	</main>

	   <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Detalles</h3>
                    <p>Tu destino para calzados y accesorios de calidad.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Servicios</h3>
                    <ul>
                        <li><a href="Servicios/guia_tallas.html">Guía de Tallas</a></li>
                        <li><a href="Servicios/preguntas.html">Preguntas Frecuentes</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Newsletter</h3>
                    <p>Suscríbete para recibir ofertas exclusivas</p>
                    <form class="newsletter-form">
                        <input type="email" placeholder="Tu email" required>
                        <button type="submit">Suscribirse</button>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Detalles. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

	<script src="../js/script.js"></script>
	<script>
		(function(){
			// helpers UI
			var chat = document.getElementById('chat');
			var queryInput = document.getElementById('query');
			var sendBtn = document.getElementById('sendBtn');
			var suggestions = document.querySelectorAll('.tag');
			var skinTone = document.getElementById('skinTone');
			var stylePref = document.getElementById('stylePref');
			var budget = document.getElementById('budget');
			var resetBtn = document.getElementById('resetProfile');

			function appendMessage(text, cls){
				var d = document.createElement('div');
				d.className = 'msg ' + cls;
				d.textContent = text;
				chat.appendChild(d);
				chat.scrollTop = chat.scrollHeight;
			}

			function buildProfile(){
				return {
					skinTone: skinTone.value,
					style: stylePref.value,
					budget: budget.value || null
				};
			}

			function sendQuery(q){
				if(!q) return;
				appendMessage(q, 'user');
				queryInput.value = '';
				// payload para backend
				var payload = { query: q, profile: buildProfile(), sessionId: null };

				// intenta enviar a /api/assistant (backend necesario). Si falla, respuesta simulada.
				fetch('/api/assistant', {
					method:'POST',
					headers:{'Content-Type':'application/json'},
					body: JSON.stringify(payload)
				})
				.then(function(res){ return res.ok ? res.json() : Promise.reject(); })
				.then(function(data){
					// se espera {reply: "...", suggestions: [...]}
					if(data && data.reply) appendMessage(data.reply, 'ai');
					else appendMessage('Lo siento, no obtuve respuesta válida del servicio IA.', 'ai');
				})
				.catch(function(){
					// respuesta simulada para testing sin backend
					var sim = 'Respuesta simulada — según tu perfil (' + buildProfile().skinTone + ', ' + buildProfile().style + '): prueba combinar tonos neutros con un accesorio en contraste.';
					appendMessage(sim, 'ai');
				});
			}

			// enviar por botón o Enter
			sendBtn.addEventListener('click', function(){ sendQuery(queryInput.value.trim()); });
			queryInput.addEventListener('keydown', function(e){ if(e.key === 'Enter'){ e.preventDefault(); sendQuery(queryInput.value.trim()); } });

			// sugerencias rápidas
			suggestions.forEach(function(s){ s.addEventListener('click', function(){ sendQuery(s.getAttribute('data-q')); }); });

			// reset perfil
			resetBtn.addEventListener('click', function(){
				skinTone.value = 'clara'; stylePref.value = 'casual'; budget.value = '';
				chat.innerHTML = '<div class="msg ai">Perfil reiniciado. Cuéntame tus preferencias.</div>';
			});

			// prevenir navegación del icono de búsqueda si existe
			var searchToggle = document.getElementById('searchToggle');
			var overlay = document.getElementById('searchOverlay');
			if(searchToggle){
				searchToggle.addEventListener('click', function(e){ e.preventDefault(); if(overlay){ overlay.classList.add('open'); document.body.classList.add('no-scroll'); } });
			}
		})();
	</script>
</body>
</html>
